{% extends 'base.html' %}
{% block content %}
<div class="container2">
    <h1>Add Course</h1>
    <form action="{{ url_for('add_course') }}" method="post" enctype="multipart/form-data">
        <label for="name">Course Name:</label>
        <input type="text" id="name" name="name" required>
        
        <label for="description">Description:</label>
        <textarea id="description" name="description" rows="3" required></textarea>
        
        <label for="level">Level:</label>
        <select id="level" name="level" required>
            <option></option>
            <option value="Beginner">Beginner</option>
            <option value="Intermediate">Intermediate</option>
            <option value="Advanced">Advanced</option>
        </select>
        
        <label for="domain">Domain:</label>
        <input type="text" id="domain" name="domain" required>
        
        <label for="language">Language:</label>
        <select id="language" name="language" required>
            <option></option>
            <option value="Hindi">Hindi</option>
            <option value="English">English</option>
        </select>
        
        <label for="payment">Payment:</label>
        <select id="payment" name="payment" onchange="showPaymentDetails()">
            <option></option>
            <option value="Free">Free</option>
            <option value="Paid">Paid</option>
        </select>

        <div id="paymentDetailsContainer" style="display: none;">
            <label for="payment_details">Payment Details:</label>
            <input type="text" id="payment_details" name="payment_details">
        </div>
        
        <label for="mode_of_class">Mode of Class:</label>
        <select id="mode_of_class" name="mode_of_class" onchange="showClassDetails()">
            <option></option>
            <option value="Live">Live</option>
            <option value="Recorded">Recorded</option>
        </select>

        <div id="classDetailsContainer" style="display: none;">
            <label for="class_details">Class Details:</label>
            <textarea id="class_details" name="class_details" rows="3"></textarea>
        </div>
        
        <label for="learner_type">Learner Type:</label>
        <select id="learner_type" name="learner_type" required>
            <option></option>
            <option value="Visual">Visual</option>
            <option value="Auditory">Auditory</option>
            <option value="Kinesthetic">Kinesthetic</option>
        </select>
        
        <label for="thumbnail_img">Thumbnail Image:</label>
        <input type="file" id="thumbnail_img" name="thumbnail_img" accept="image/*">
        
        <label for="temp_video">Sample Video:</label>
        <input type="file" id="temp_video" name="temp_video" accept="video/*">
        
        <div id="chaptersContainer">
            <label>Chapters:</label>
            <div id="chapterFields">
                <!-- Chapter fields will be dynamically added here -->
            </div>
            <button type="button" onclick="addChapter()">Add Chapter</button>
        </div><br>
        
        <!-- Submit Button -->
        <button type="submit">Submit</button>
    </form>
</div>

<script>
    let chapterCount = 0;

    function addChapter() {
        chapterCount++;
        let chapterFields = document.getElementById('chapterFields');

        let chapterDiv = document.createElement('div');
        chapterDiv.setAttribute('class', 'chapter');
        chapterDiv.innerHTML = `
            <hr>
            <h3>Chapter ${chapterCount}</h3>
            <label>Title of Chapter:</label>
            <input type="text" name="chapter_${chapterCount}_title" required><br>

            <label>Description:</label>
            <textarea name="chapter_${chapterCount}_description" rows="3" required></textarea><br>

            <label>Number of Assignment Files:</label>
            <input type="number" id="chapter_${chapterCount}_num_assignment_files" min="0" onchange="addAssignmentFileFields(this.value, ${chapterCount})"><br>

            <div id="assignmentFileFields_${chapterCount}"></div><br>

            <label>Number of Resource Files:</label>
            <input type="number" id="chapter_${chapterCount}_num_resource_files" min="0" onchange="addResourceFileFields(this.value, ${chapterCount})"><br>

            <div id="resourceFileFields_${chapterCount}"></div><br>

            <label>Note:</label>
            <textarea name="chapter_${chapterCount}_note" rows="3"></textarea><br>

            <label>Course File (Video/Audio/PDF/DOCX):</label>
            <input type="file" name="chapter_${chapterCount}_course_file" accept="video/*,.pdf,.docx,.doc,.ppt,.pptx"><br>
        `;
        chapterFields.appendChild(chapterDiv);
    }

    function addAssignmentFileFields(numFiles, chapterCount) {
        let assignmentFileFields = document.getElementById(`assignmentFileFields_${chapterCount}`);
        assignmentFileFields.innerHTML = ''; // Clear previous fields

        for (let i = 1; i <= numFiles; i++) {
            let fileInput = document.createElement('input');
            fileInput.setAttribute('type', 'file');
            fileInput.setAttribute('name', `chapter_${chapterCount}_assignment_file_${i}`);
            fileInput.setAttribute('accept', '.pdf,.docx,image/*');
            fileInput.setAttribute('required', 'true');
            fileInput.style.marginBottom = '5px';

            let label = document.createElement('label');
            label.innerHTML = `Assignment File ${i}:`;
            label.appendChild(fileInput);
            assignmentFileFields.appendChild(label);
        }
    }

    function addResourceFileFields(numFiles, chapterCount) {
        let resourceFileFields = document.getElementById(`resourceFileFields_${chapterCount}`);
        resourceFileFields.innerHTML = ''; // Clear previous fields

        for (let i = 1; i <= numFiles; i++) {
            let fileInput = document.createElement('input');
            fileInput.setAttribute('type', 'file');
            fileInput.setAttribute('name', `chapter_${chapterCount}_resource_file_${i}`);
            fileInput.setAttribute('multiple', 'true');
            fileInput.style.marginBottom = '5px';

            let label = document.createElement('label');
            label.innerHTML = `Resource File ${i}:`;
            label.appendChild(fileInput);
            resourceFileFields.appendChild(label);
        }
    }

    function showPaymentDetails() {
        var payment = document.getElementById("payment").value;
        var paymentDetailsContainer = document.getElementById("paymentDetailsContainer");

        if (payment === "Paid") {
            paymentDetailsContainer.style.display = "block";
        } else {
            paymentDetailsContainer.style.display = "none";
        }
    }

    
</script>
{% endblock %}
